
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(readr)
library(dplyr)
library(tidyr)
library(purrr) 
```


```{r, include=FALSE}
# Read datasets
demographics_nsw_2021 <- read.csv("demographics_nsw_2021.csv")
socioeconomics_nsw_2021 <- read.csv("socioeconomics_nsw_2021.csv")
health_conditions_nsw_2021 <- read.csv("health_conditions_nsw_2021.csv")
```

```{r}

lock_cols <- c("pop_size", "in_wslhd", "in_metro")

# Merge all variables
cencus_nsw_2021 <- list(
  demographics_nsw_2021,                                
  socioeconomics_nsw_2021 %>% select(-any_of(lock_cols)),  
  health_conditions_nsw_2021 %>% select(-any_of(lock_cols))
) %>%
  reduce(left_join, by = "sa2_name_2021")

write_csv(cencus_nsw_2021, "cencus_nsw_2021.csv")
```


