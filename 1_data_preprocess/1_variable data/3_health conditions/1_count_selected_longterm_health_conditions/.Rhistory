knitr::opts_chunk$set(echo = TRUE)
# Import package
library(dplyr)
library(readr)
# Check invalid lines for head and tail
all_lines <- readLines("cont_seltd_heal_cons_by_sa2_raw_2021.csv")
length(all_lines)
head(all_lines, 11)
tail(all_lines, 9)
# Remove invalid lines
clean_lines <- all_lines[11:(length(all_lines) - 9)]
# define temporary file name
temp_file <- "cont_seltd_heal_cons_by_sa2_temp_2021.csv"
# Save temporary file for document
writeLines(clean_lines, temp_file)
# read temporary file
cont_seltd_heal_cons_2021 <- read_csv(temp_file)
# Display data frame
head(cont_seltd_heal_cons_2021)
# Remove NA column
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% select(where(~ !all(is.na(.))))
# Remove 'Total' column
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% select(-Total)
# Remove 'SA2 (UR)' row
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% filter(.[[1]] != "SA2 (UR)")
# Rename sa2
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% rename(sa2 = '1-digit level BPLP Country of Birth of Person')
# Remove invalid lines
clean_lines <- all_lines[11:(length(all_lines) - 9)]
# define temporary file name
temp_file <- "cont_seltd_heal_cons_by_sa2_temp_2021.csv"
# Save temporary file for document
writeLines(clean_lines, temp_file)
# read temporary file
cont_seltd_heal_cons_2021 <- read_csv(temp_file)
# Display data frame
head(cont_seltd_heal_cons_2021)
# Remove NA column
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% select(where(~ !all(is.na(.))))
# Remove 'Total' column
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% select(-Total)
# Remove 'SA2 (UR)' row
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% filter(.[[1]] != "SA2 (UR)")
# Rename sa2
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% rename(sa2 = 'LTHP Count of Selected Long-term Health Conditions')
# Remove NA column
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% select(where(~ !all(is.na(.))))
# Remove 'Total' column
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% select(-Total)
# Remove invalid lines
clean_lines <- all_lines[11:(length(all_lines) - 9)]
# define temporary file name
temp_file <- "cont_seltd_heal_cons_by_sa2_temp_2021.csv"
# Save temporary file for document
writeLines(clean_lines, temp_file)
# read temporary file
cont_seltd_heal_cons_2021 <- read_csv(temp_file)
# Display data frame
head(cont_seltd_heal_cons_2021)
# Remove NA column
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% select(where(~ !all(is.na(.))))
# Remove 'Total' column
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% select(-Total)
# Remove 'SA2 (UR)' row
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% filter(.[[1]] != "SA2 (UR)")
# Rename sa2
cont_seltd_heal_cons_2021 <- cont_seltd_heal_cons_2021 %>% rename(sa2 = 'CLTHP Count of Selected Long-term Health Conditions')
# Check data frame
head(cont_seltd_heal_cons_2021)
# Read wslhd sa2 file
wslhd_sa2_2021 <- read_csv('wslhd_sa2_2021.csv')
# Filter wslhd data for cont_seltd_heal_cons_2021
cont_seltd_heal_cons_wslhd_2021 <- cont_seltd_heal_cons_2021 %>%
semi_join(wslhd_sa2_2021, by = "sa2")
# Check data frame
head(cont_seltd_heal_cons_wslhd_2021)
nrow(cont_seltd_heal_cons_wslhd_2021)
# Save wslhd cont_seltd_heal_cons_2021 for document
write_csv(cont_seltd_heal_cons_wslhd_2021, "cont_seltd_heal_cons_wslhd_2021.csv")
